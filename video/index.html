<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>動画コンテンツ - Lopan café</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="description" content="Lopan caféはLopan.jpがよく使うパターン集。レイアウトとUIとエフェクトとコンポーネント、例えばアーカイブ一覧やモーダルやタブやアコーディオン。">
<meta property="og:site_name" content="Lopan.jp">
<meta property="og:type" content="website">
<meta property="og:title" content="動画コンテンツ - Lopan café">
<meta property="og:description" content="Lopan caféはLopan.jpがよく使うパターン集。レイアウトとUIとエフェクトとコンポーネント、例えばアーカイブ一覧やモーダルやタブやアコーディオン。">
<meta property="og:url" content="https://lopan.cafe/component/">
<meta property="og:image" content="https://lopan.cafe/component/ogp.jpg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@_watercolor">
<meta name="theme-color" content="#86c0de">
<meta name="msapplication-navbutton-color" content="#86c0de">
<link rel="icon" href="../assets/icon.png">
<link rel="apple-touch-icon" href="../assets/apple-touch-icon.png">
<link rel="stylesheet" href="../assets/css/common.css">
<link rel="stylesheet" href="../assets/css/component.css">
<link rel="stylesheet" href="css/style.css">
<script src="../assets/js/script.js" type="module" crossorigin="anonymous" defer></script>
</head>
<body>
<header class="l-header">
	<h1 class="logo"><a href="../"><svg width="40" height="37" viewBox="0 0 40 37" class="pan" fill="none"><title>Lopan.jp</title><use href="#panchan"/></svg></a></h1>
	<ul class="menu -nav">
		<li><a href="../#about">About</a></li>
		<li><a href="../#news">News</a></li>
		<li><a href="../#works">Works</a></li>
		<li><a href="../#store">Store</a></li>
		<li><a href="../#contact">Contact</a></li>
	</ul>
	<ul class="menu -sns">
		<li><a href="https://www.instagram.com/lopan.jp/"><svg width="24" height="24" viewBox="0 0 24 24" class="ico"><use href="../assets/img/ico.svg#instagram"/></svg></a></li>
		<li><a href="https://twitter.com/_watercolor"><svg width="24" height="24" viewBox="0 0 24 24" class="ico"><use href="../assets/img/ico.svg#twitter"/></svg></a></li>
	</ul>
</header>

<button type="button" class="l-drawer js-menuToggle"><svg width="32" height="5" viewBox="0 0 32 5" class="bar -b1"><path d="M0,2.5H32"/></svg><svg width="32" height="5" viewBox="0 0 32 5" class="bar -b2"><path d="M0,2.5H32"/></svg><svg width="32" height="5" viewBox="0 0 32 5" class="bar -b3"><path d="M0,2.5H32"/></svg></button>
<nav class="l-menu">
	<div class="overlay js-menuToggle"></div>
	<div class="container">
		<h2 class="visuallyhidden">ナビゲーション</h2>
		<ul class="menu -nav">
			<li><a href="../#about">About</a></li>
			<li><a href="../#news">News</a></li>
			<li><a href="../#works">Works</a></li>
			<li><a href="../#store">Store</a></li>
			<li><a href="../#contact">Contact</a></li>
		</ul>
		<ul class="menu -sns">
			<li><a href="https://www.instagram.com/lopan.jp/"><svg width="24" height="24" viewBox="0 0 24 24" class="ico"><use href="../assets/img/ico.svg#instagram"/></svg></a></li>
			<li><a href="https://twitter.com/_watercolor"><svg width="24" height="24" viewBox="0 0 24 24" class="ico"><use href="../assets/img/ico.svg#twitter"/></svg></a></li>
		</ul>
		<a href="#top" class="pagetop js-anc"><svg width="24" height="24" viewBox="0 0 24 24" class="ico"><path d="M2,18L12,6l10,12"/></svg></a>
	</div>
</nav>

<main class="l-main page-video">
	<div class="p-visual"></div>
	<div class="c-crumb">
		<a href="../">Home</a>
		<a href="./" aria-current="page">動画コンテンツ</a>
	</div>
	<div class="p-intro l-section">
		<h1 class="intro_title c-title -sand">動画コンテンツ</h1>
		<p class="c-lead">Webサイトに動画を読み込み再生する方法。</p>
		<p>ここでは、HTMLの<b>video要素</b>を使って設置した動画メディア、または、<b>IFrame Player API</b>を使った「YouTube 埋め込み動画」を、別途設置したボタンから動画の再生、一時停止を操作する方法について。</p>
	</div>
	
	<section class="p-video_elements l-section">
		<h2 class="c-title -bar">video要素</h2>
		<p class="c-lead">video要素を使った動画の実装。</p>
		<p>基本は以下の通り、video要素には動画メディアのサイズを記述、その中にsource要素を入れsrc属性で<b>webm</b>、<b>mp4</b>ふたつのフォーマットで動画を用意。</p>
		<figure class="c-syntax" data-lang="html">
			&lt;video width="640" height="360"&gt;
				&lt;source src="assets/media/video.webm" type="video/webm"&gt;
				&lt;source src="assets/media/video.mp4" type="video/mp4"&gt;
			&lt;/video&gt;
			&lt;button type="button"&gt;ボタン&lt;/button&gt;
		</figure>
		<p>動画の再生は<code>play()</code>メソッド、一時停止は<code>pause()</code>メソッドで操作できる。ボタンをクリックした時、video要素が一時停止中であれば再生し、そうでなければ一時停止する。</p>
		<figure class="c-syntax" data-lang="js">
			const video = document.getElementsByTagName('video')[0];
			const button = document.getElementsByTagName('button')[0];
			button.addEventListener('click', () => {
				if (video.paused) {
					video.play();
				} else {
					video.pause();
				}
			});
		</figure>
		<section class="elements_section l-section">
			<h3 class="c-title -bar">実装例</h3>
			<div class="c-video">
				<div class="wrap">
					<video width="640" height="360" class="js-video" data-video="sampleVideo">
						<source src="../assets/media/video.webm" type="video/webm">
						<source src="../assets/media/video.mp4" type="video/mp4">
					</video>
				</div>
				<div class="poster js-videoControl" data-video="sampleVideo">
					<img src="../assets/media/poster.webp" alt="" width="640" height="360" loading="lazy">
					<span class="play">再生する</button>
				</div>
			</div>
			<p>HTMLは以下の構成で用意。</p>
			<ol class="c-numlist">
				<li>div要素<small>（<code>.c-video</code>）</small>の中にdiv要素をふたつ<small>（<code>.wrap</code>と<code>.poster</code>）</small>用意。</li>
				<li><code>.wrap</code>には<b>video要素</b>、<code>.poster</code>には一時停止時に表示される<b>アイキャッチ画像</b>と<b>再生ボタンとなる要素</b>を設置。</li>
				<li>video要素のclass属性に「<code>js-video</code>」を指定し、<b>再生停止ボタンにしたい要素</b>のclass属性に「<code>js-videoControl</code>」を指定。</li>
				<li><code>.js-video</code>と<code>.js-videoControl</code>に<b>data-video属性</b>を付与し、それぞれに同じユニークな値を指定し紐づける。</li>
			</ol>
			<p>それをその下のCSSでスタイリング。</p>
			<figure class="c-syntax" data-lang="html">
				&lt;div class="c-video"&gt;
					&lt;div class="wrap"&gt;
						&lt;video width="640" height="360" class="js-video" data-video="sampleVideo"&gt;
							&lt;source src="../assets/media/video.webm" type="video/webm"&gt;
							&lt;source src="../assets/media/video.mp4" type="video/mp4"&gt;
						&lt;/video&gt;
					&lt;/div&gt;
					&lt;div class="poster js-videoControl" data-video="sampleVideo"&gt;
						&lt;img src="../assets/media/poster.webp" alt="" width="640" height="360" loading="lazy"&gt;
						&lt;span class="play"&gt;再生する&lt;/button&gt;
					&lt;/div&gt;
				&lt;/div&gt;
			</figure>
			<figure class="c-syntax -shortcut" data-lang="css">
				.c-video {
					position: relative;
					border: 10px solid #fff;
					border-radius: 16px;
					background: #fff;
					box-shadow: 0 2px 8px #3730391a;
				}
				.c-video .wrap {
					pointer-events: none;
					aspect-ratio: 16 / 9;
				}
				.c-video .wrap > *,
				.c-video .poster,
				.c-video .poster::after {
					position: absolute;
					top: 0;
					left: 0;
					width: 100%;
					height: 100%;
				}
				.c-video .wrap > *,
				.c-video .poster::after,
				.c-video .poster img {
					border-radius: 8px;
				}
				.c-video .poster {
					cursor: pointer;
					transition: opacity .3s;
				}
				.c-video.is-playing .poster {
					opacity: 0;
				}
				.c-video .poster::after {
					content: "";
					background: rgba(0,0,0,.2);
				}
				.c-video .poster img {
					width: 100%;
					height: 100%;
					object-fit: cover;
				}
				.c-video .play {
					pointer-events: none;
					z-index: 1;
					position: absolute;
					top: calc(50% - 20px);
					left: calc(50% - 20px);
					width: 48px;
					height: 48px;
					padding: 0;
					border: 0;
					border-radius: 40px;
					color: transparent;
					background: rgba(255,255,255,.9);
					-webkit-appearance: none;
					-moz-appearance: none;
					appearance: none;
				}
				.c-video .play::after {
					content: "";
					position: absolute;
					top: calc(50% - 8px);
					left: calc(50% - 6px);
					width: 15px;
					height: 16px;
					background: linear-gradient(to bottom left, transparent 48%, #86c0de 52%) top left / 100% 50% no-repeat,
						linear-gradient(to top left, transparent 48%, #86c0de 52%) bottom left / 100% 50% no-repeat;
				}
				@media (hover: hover) {
					.c-video .play {
						transition: transform .4s cubic-bezier(.3,1,.7,1);
					}
					.c-video .poster::after {
						transition: background .4s;
					}
					.c-video:hover .play {
						transform: scale(1.2);
						transition-duration: .1s;
					}
					.c-video:hover .poster::after {
						background: rgba(0,0,0,.1);
						transition-duration: .1s;
					}
				}
			</figure>
			<p></p>
			<figure class="c-syntax -shortcut" data-lang="js" data-caption="要約<small>（詳細は<a href='../assets/js/video.js' class='c-textlink'>ソースコード</a>を参照のこと）</small>">
				const elm = document.getElementsByClassName('js-video')[0];
				const id = elm.dataset.video;
				const button = document.querySelector(`.js-videoControl[data-video=${id}]`);
				button.tabIndex = 0;
				this.videoData[id] = {
					isPlaying: false,
					container: elm.closest('.c-video'),
					video: elm,
					button: button
				};
				button.addEventListener('click', e => {
					if (!this.videoData[id].isPlaying) {
						this.videoData[id].isPlaying = true;
						this.videoData[id].video.play();
						if (this.videoData[id].container !== null) {
							// 親要素に c-video があったら is-playing を付与する
							this.videoData[id].container.classList.add('is-playing');
						}
					} else {
						this.videoData[id].isPlaying = false;
						this.videoData[id].video.pause();
						if (this.videoData[id].container !== null) {
							// 親要素に c-video があったら is-playing を外す
							this.videoData[id].container.classList.remove('is-playing');
						}
					}	
				});
			</figure>
		</section>
	</section>
	
	<section class="p-video_yt l-section">
		<h2 class="c-title -bar">YouTube 埋め込みプレーヤー</h2>
		<p class="c-lead">IFrame Player APIを使った動画の実装。</p>
		<div class="c-video">
			<div class="wrap">
				<div class="js-yt" width="640" height="360" data-player="samplePlayer" data-ytid="2oZbfE-W3CM"></div>
			</div>
			<div class="poster js-ytControl" data-player="samplePlayer">
				<img src="../assets/media/ytplayer.webp" alt="" width="640" height="360" loading="lazy">
				<span class="play">再生する</span>
			</div>
		</div>
		<p>HTMLは以下の構成で用意、ほとんどvideo要素のと同じ。</p>
		<ol class="c-numlist">
			<li>div要素<small>（<code>.c-video</code>）</small>の中にdiv要素をふたつ<small>（<code>.wrap</code>と<code>.poster</code>）</small>用意。</li>
			<li><code>.wrap</code>には<b>div要素</b>を設置し、class属性に「<code>js-yt</code>」を指定、<b>data-ytid属性</b>にYouTubeの<b>動画ID</b>を指定する。</li>
			<li><code>.poster</code>には一時停止時に表示される<b>アイキャッチ画像</b>と<b>再生ボタンとなる要素</b>を設置。</li>
			<li><b>再生停止ボタンにしたい要素</b>のclass属性に「<code>js-videoControl</code>」を指定。</li>
			<li><code>.js-yt</code>と<code>.js-ytControl</code>に<b>data-player属性</b>を付与し、それぞれに同じユニークな値を指定し紐づける。</li>
		</ol>
		<p>CSSはvideo要素のと同じ。</p>
		<figure class="c-syntax" data-lang="html">
			&lt;div class="c-video"&gt;
				&lt;div class="wrap"&gt;
					&lt;div class="js-yt" width="640" height="360" data-player="samplePlayer" data-ytid="2oZbfE-W3CM"&gt;&lt;/div&gt;
				&lt;/div&gt;
				&lt;div class="poster js-ytControl" data-player="samplePlayer"&gt;
					&lt;img src="../assets/media/ytplayer.webp" alt="" width="640" height="360" loading="lazy"&gt;
					&lt;span class="play"&gt;再生する&lt;/span&gt;
				&lt;/div&gt;
			&lt;/div&gt;
		</figure>
		<p></p>
		<figure class="c-syntax -shortcut" data-lang="js" data-caption="要約<small>（詳細は<a href='../assets/js/video.js' class='c-textlink'>ソースコード</a>を参照のこと）</small>">
			const elm = document.getElementsByClassName('js-yt')[0];
			const id = elm.dataset.player;
			elm.tabIndex = -1;
			elm.id = id;
			
			const w = elm.width ? elm.width : 560;
			const h = elm.height ? elm.height : 315;
			const ytid = elm.dataset.ytid;
			
			const playerVars = { controls: 0, modestbranding: 1, enablejsapi: 1, playsinline: 1, rel: 0 };
			if (elm.dataset.vars !== undefined) {
				// data-vars 属性があったらパラメータにして playerVars に上書き
				const vars = elm.dataset.vars.split('&');
				let param = [];
				for (let i = 0, len = vars.length; i < len; i++) {
					param = vars[i].split('=');
					playerVars[param[0]] = param[1];
				}
			}
			const player = new YT.Player(id, {
				width: w, height: h, videoId: ytid, playerVars: playerVars,
				events: {
					'onReady': e => {
						if (parseInt(playerVars.autoplay)) {
							e.target.mute();
						}
					},
					'onStateChange': e => {
						if (e.target.container !== null) {
							// 親要素に c-video があったら is-playing を付け外しする
							if (e.data === 1 || e.data === -1) {
								e.target.container.classList.add('is-playing');
							} else {
								e.target.container.classList.remove('is-playing');
							}
						}
					}
				},
			});
			player.container = player.getIframe().closest('.c-video');
			
			const button = document.querySelector(`.js-ytControl[data-player=${id}]`);
			button.tabIndex = 0;
			button.addEventListener('click', () => {
				onPlay();
			});
			
			function onPlay() {
				if (player === undefined) return;
				if (player.getPlayerState() !== 1) {
					player.playVideo();
				} else {
					player.pauseVideo();
				}
			}
		</figure>
	</section>
</main>

<footer class="l-footer">
	<div class="contentsinfo">
		<h1 class="logo"><a href="https://lopan.cafe/component/">
			<svg width="40" height="37" viewBox="0 0 40 37" class="pan"><use href="#panchan"/></svg>
			<span class="madeby">Made by Lopan.jp</span>
		</a></h1>
		<ul class="menu -nav">
			<li><a href="../#about">About</a></li>
			<li><a href="../#news">News</a></li>
			<li><a href="../#works">Works</a></li>
			<li><a href="../#store">Store</a></li>
			<li><a href="../#contact">Contact</a></li>
		</ul>
		<ul class="menu -other">
			<li><a href="../privacypolicy/" aria-current="page">プライバシーポリシー</a></li>
		</ul>
		<ul class="menu -sns">
			<li><a href="https://www.instagram.com/lopan.jp/"><svg width="24" height="24" viewBox="0 0 24 24" class="ico"><use href="../assets/img/ico.svg#instagram"/></svg></a></li>
			<li><a href="https://twitter.com/_watercolor"><svg width="24" height="24" viewBox="0 0 24 24" class="ico"><use href="../assets/img/ico.svg#twitter"/></svg></a></li>
			<li><a href="https://line.me/ja/"><svg width="24" height="24" viewBox="0 0 24 24" class="ico"><use href="../assets/img/ico.svg#line"/></svg></a></li>
			<li><a href="https://ja-jp.facebook.com/"><svg width="24" height="24" viewBox="0 0 24 24" class="ico"><use href="../assets/img/ico.svg#facebook"/></svg></a></li>
			<li><a href="https://www.youtube.com/"><svg width="24" height="24" viewBox="0 0 24 24" class="ico"><use href="../assets/img/ico.svg#youtube"/></svg></a></li>
			<li><a href="https://www.tiktok.com/ja-JP/"><svg width="24" height="24" viewBox="0 0 24 24" class="ico"><use href="../assets/img/ico.svg#tiktok"/></svg></a></li>
			<li><a href="https://www.spotify.com/jp/"><svg width="24" height="24" viewBox="0 0 24 24" class="ico"><use href="../assets/img/ico.svg#spotify"/></svg></a></li>
		</ul>
		<p class="address">〒150-0068<br>Lopan café <wbr>Lopan-tori 6-8-10<br>Shibuya-ku Shibuya <wbr>Tokyo</p>
		<a href="#top" class="pagetop js-anc"><svg width="24" height="24" viewBox="0 0 24 24" class="ico"><path d="M2,18L12,6l10,12"/></svg></a>
	</div>
	<p class="copyright"><small>© 2006 Lopan.jp</small></p>
</footer>

<svg class="visuallyhidden">
<symbol id="panchan" fill="none"><g stroke-width="0.9"><path d="M11.812,16.727A2.736,2.736,0,0,0,10.745,21.5"/><path d="M14.41,16.963c-2.364,1.069-2.461,3.882-.375,4.924"/><path d="M16.958,16.991c-2,1.09-2,3.9.229,4.533"/><path d="M15.242,31.485a13,13,0,0,1-1.58,1.244,11.759,11.759,0,0,1-1.385-1.468"/></g><g stroke-width="1.6"><path d="M7.362,24.651c-.785,0-.82,1.3-.009,1.3C8.084,25.946,8.105,24.651,7.362,24.651Z"/><path d="M19.759,24.781c-.857-.019-.867,1.375-.009,1.394A.7.7,0,0,0,19.759,24.781Z"/></g><g stroke-width="1.2"><path d="M9.018,14.374C9.627,9.719,7.838,4.529,2.349.746-.7,9.074.207,14.869,5.313,19.025"/><path d="M23.6,18.577c-2.08,6.649-.916,13.019,5.5,15.613,2.318-6.822,1.137-13.058-4.087-18.288C18.268,9.143,5.3,12.276,4.631,22.869,3.962,33.439,16.12,35.346,24.349,30.8"/><path d="M26.22,16.783c6.287-2.347,13.18,2.065,13.18,10.11,0,7.656-7.42,8.6-9.813,6.271"/><path d="M30.4,27.894A4.643,4.643,0,0,1,34.14,26.1"/><path d="M7.883,31.148C5.25,32.1,5.343,35.6,9.078,36c2.33.25,3.657-1.135,3.116-3.062"/><path d="M18.156,33c-.733,1.94.548,3.573,3.347,3.2,2.829-.38,3.709-2.882,2.038-4.7"/></g></symbol>
</svg>
</body>
</html>